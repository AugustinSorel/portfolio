---
import ThemeToggler from "./themeToggler.astro";
---

<header
  class="flex items-center justify-between px-max-width z-20 fixed top-0 left-0 right-0 h-header"
>
  <nav
    class="border capitalize text-xs md:text-sm border-border px-2 py-1.5 rounded-full flex gap-1 items-center backdrop-blur-md"
    id="main-nav"
  >
    <a
      href="#about"
      class="md:px-5 px-2 py-2 rounded-full w-16 text-center aria-[current=true]:bg-primary transition-colors md:w-24 aria-[current=true]:backdrop-blur-md hover:text-muted-foreground"
      >about</a
    >
    <a
      href="#projects"
      class="md:px-5 px-2 py-2 rounded-full w-16 text-center aria-[current=true]:bg-primary transition-colors md:w-24 aria-[current=true]:backdrop-blur-md hover:text-muted-foreground"
      >projects</a
    >
    <a
      href="#stack"
      class="md:px-5 px-2 py-2 rounded-full w-16 text-center aria-[current=true]:bg-primary transition-colors md:w-24 aria-[current=true]:backdrop-blur-md hover:text-muted-foreground"
      >stack</a
    >
  </nav>
  <ThemeToggler />
</header>

<script>
  const mainNav = document.querySelector("#main-nav");

  if (!mainNav) {
    throw new Error("Main nav not found");
  }

  const allAnchors = mainNav.querySelectorAll("a");

  const selectCurrentAnchor = () => {
    const currentPath = window.location.href.split("#")[1] || "about";
    allAnchors.forEach((anchor) => {
      anchor.setAttribute("aria-current", "false");
      if (anchor.getAttribute("href") === `#${currentPath}`) {
        anchor.setAttribute("aria-current", "true");
      }
    });
  };

  window.addEventListener("hashchange", selectCurrentAnchor);

  selectCurrentAnchor();
</script>
